{% extends "base_generic.html"%}

{% block content %}
		<script>
			
			function changeFill(cell_id) {
				cell = document.getElementById(cell_id);
				if (cell.href.baseVal === '#line_cell_off') {
					cell.href.baseVal = '#line_cell';
				}
				else {
					cell.href.baseVal = '#line_cell_off';
				};
			};
			
			function getControl(element_id, command) {
				let requestJSON = {
					'element_id':element_id,
					'command': command
				};
				let req = new XMLHttpRequest();
				req.open("GET", "control?");
				req.onreadystatechange = function() {
					if(this.readyState === 4 && this.status === 200) {
						elementStatus = JSON.parse(this.response);
						if (elementStatus.id === element_id) {
							let elem = document.getElementById(element_id);
							console.log('command:', command);
							if (elem.getAttribute('data-type') === 'cell'){
								if (elementStatus.value === 'on') {
									elem.href.baseVal ='#line_cell';
								}
								else {
									elem.href.baseVal ='#line_cell_off';
								};
							};
						};
					};
				};
				req.send(JSON.stringify(requestJSON));
			};

			function getParameters() {
				setInterval(
					function() {
						var req = new XMLHttpRequest();
						req.open("GET", "parameters?");
						req.onreadystatechange = function() {
							if(this.readyState === 4 && this.status === 200) {
								parameters = JSON.parse(this.response);
								for(let i=0; i < parameters.length; i++) {
									let elem = document.getElementById(parameters[i].id);
									if(elem) {
										if (elem.getAttribute('data-type') === 'cell'){
											if (parameters[i].value === 'on') {
												elem.href.baseVal ='#line_cell';
											}
											else {
												elem.href.baseVal ='#line_cell_off';
											};
										}
										else {
											elem.innerHTML = parameters[i].value;
										};
									};
								};
							};
						};
						req.send();
					}, 
					5000
				);
			}

			getParameters();

		</script>
		<svg id="switchgear_10" class="switchgear" xmlns="http://www.w3.org/2000/svg"  width="1832" height="600" viewBox="-1 -1 1834 600" version="1.1">
			<defs>
				<symbol id="line_cell" data-type="" stroke="dark" fill="none" stroke-width="0.5" viewBox="0 0 40 150">
					<circle cx="3" cy="63" r="3"/>
					<line x1="11" y1="14" x2="11" y2="2"/>
					<line x1="11" y1="14" x2="14" y2="10" />
					<line x1="8" y1="10" x2="11" y2="14" />
					<line x1="11" y1="16" x2="14" y2="12" />
					<line x1="8" y1="12" x2="11" y2="16" />
					<circle cx="3" cy="52" r="3"/>
					<line x1="22" y1="51" x2="23" y2="51" />
					<line x1="22" y1="53" x2="23" y2="53" />
					<circle cx="19" cy="52" r="3"/>
					<line x1="6" y1="51" x2="7" y2="51" />
					<line x1="6" y1="53" x2="7" y2="53" />
					<line x1="11" y1="38" x2="14" y2="42" />
					<line x1="8" y1="42" x2="11" y2="38" />
					<line x1="11" y1="36" x2="14" y2="40" />
					<line x1="8" y1="40" x2="11" y2="36" />
					<line x1="11" y1="29" x2="11" y2="36" />
					<line x1="7" y1="22" x2="11" y2="29" />
					<line x1="12" y1="21" x2="10" y2="23" />
					<line x1="10" y1="21" x2="12" y2="23" />
					<rect name="switch" x="5" y="18" width="12" height="16" fill="white" fill-opacity="50%" style="cursor: pointer;"/>
					<line x1="11" y1="22" x2="11" y2="16" />
					<line x1="40" y1="84" x2="40" y2="86" />
					<line x1="38" y1="83" x2="38" y2="87" />
					<line x1="11" y1="118" x2="11" y2="100" />
					<circle cx="19" cy="63" r="3"/>
					<line x1="36" y1="82" x2="36" y2="88" />
					<line x1="31" y1="85" x2="36" y2="85" />
					<line x1="26" y1="80" x2="31" y2="85" />
					<line x1="25" y1="83" x2="25" y2="87" />
					<line x1="11" y1="85" x2="25" y2="85" />
					<circle cx="11" cy="85" r="1"/>
					<line x1="22" y1="62" x2="23" y2="62" />
					<line x1="22" y1="64" x2="23" y2="64" />
					<circle cx="11" cy="2" r="1"/>
					<line x1="6" y1="62" x2="7" y2="62" />
					<line x1="6" y1="64" x2="7" y2="64" />
					<line x1="11" y1="122" x2="11" y2="128" />
					<line x1="11" y1="122" x2="9" y2="118" />
					<line x1="13" y1="118" x2="11" y2="122" />
					<line x1="9" y1="118" x2="13" y2="118" />
					<line x1="19" y1="47" x2="19" y2="68" />
					<line x1="3" y1="47" x2="3" y2="68" />
					<line x1="11" y1="38" x2="11" y2="100" />
				</symbol>
				<symbol id="line_cell_off" stroke="red" fill="none" stroke-width="0.5" viewBox="0 0 40 150">
					<circle cx="3" cy="63" r="3"/>
					<line x1="11" y1="14" x2="11" y2="2"/>
					<line x1="11" y1="14" x2="14" y2="10" />
					<line x1="8" y1="10" x2="11" y2="14" />
					<line x1="11" y1="16" x2="14" y2="12" />
					<line x1="8" y1="12" x2="11" y2="16" />
					<circle cx="3" cy="52" r="3"/>
					<line x1="22" y1="51" x2="23" y2="51" />
					<line x1="22" y1="53" x2="23" y2="53" />
					<circle cx="19" cy="52" r="3"/>
					<line x1="6" y1="51" x2="7" y2="51" />
					<line x1="6" y1="53" x2="7" y2="53" />
					<line x1="11" y1="38" x2="14" y2="42" />
					<line x1="8" y1="42" x2="11" y2="38" />
					<line x1="11" y1="36" x2="14" y2="40" />
					<line x1="8" y1="40" x2="11" y2="36" />
					<line x1="11" y1="29" x2="11" y2="36" />
					<line x1="7" y1="22" x2="11" y2="29" />
					<line x1="12" y1="21" x2="10" y2="23" />
					<line x1="10" y1="21" x2="12" y2="23" />
					<rect name="switch" x="5" y="18" width="12" height="16" fill="black" fill-opacity="50%" style="cursor: pointer;"/>
					<line x1="11" y1="22" x2="11" y2="16" />
					<line x1="40" y1="84" x2="40" y2="86" />
					<line x1="38" y1="83" x2="38" y2="87" />
					<line x1="11" y1="118" x2="11" y2="100" />
					<circle cx="19" cy="63" r="3"/>
					<line x1="36" y1="82" x2="36" y2="88" />
					<line x1="31" y1="85" x2="36" y2="85" />
					<line x1="26" y1="80" x2="31" y2="85" />
					<line x1="25" y1="83" x2="25" y2="87" />
					<line x1="11" y1="85" x2="25" y2="85" />
					<circle cx="11" cy="85" r="1"/>
					<line x1="22" y1="62" x2="23" y2="62" />
					<line x1="22" y1="64" x2="23" y2="64" />
					<circle cx="11" cy="2" r="1"/>
					<line x1="6" y1="62" x2="7" y2="62" />
					<line x1="6" y1="64" x2="7" y2="64" />
					<line x1="11" y1="122" x2="11" y2="128" />
					<line x1="11" y1="122" x2="9" y2="118" />
					<line x1="13" y1="118" x2="11" y2="122" />
					<line x1="9" y1="118" x2="13" y2="118" />
					<line x1="19" y1="47" x2="19" y2="68" />
					<line x1="3" y1="47" x2="3" y2="68" />
					<line x1="11" y1="38" x2="11" y2="100" />
				</symbol>
			</defs>
			<g stroke-width="1" fill="none" stroke="black">
				<rect x="80" y="100" width="480" height="12"/>
				<use id="cell_01" data-type="cell" xlink:href="#line_cell" x="100" y="100" width="120" height="450" onclick="getControl('cell_01', 'off'); "/>
				<text id="cell_01_current" x="200" y="220px" font-size="28px" stroke="black" stroke-width="0.5" fill="black">000<text>
			</g>
		</svg>
{% endblock %}